# æŠ€æœ¯æ¶æ„æ–‡æ¡£

## ğŸ“‹ æŠ€æœ¯æ ˆæ¦‚è§ˆ

### æ ¸å¿ƒæŠ€æœ¯é€‰å‹

```
å‰ç«¯æ„å»ºï¼šVite 5.x
æ¸¸æˆå¼•æ“ï¼šPhaser 3.80+
å¼€å‘è¯­è¨€ï¼šTypeScript 5.x
çŠ¶æ€ç®¡ç†ï¼šZustand
UIæ¡†æ¶ï¼šReact 18 (ä»…ç”¨äºèœå•/UIç•Œé¢)
æ ·å¼æ–¹æ¡ˆï¼šTailwindCSS (UIéƒ¨åˆ†)
åç«¯ï¼šNode.js + Express (å¯é€‰ï¼Œç”¨äºæ’è¡Œæ¦œ/äº‘å­˜æ¡£)
æ•°æ®åº“ï¼šSQLite/PostgreSQL (å¯é€‰)
éƒ¨ç½²ï¼šVercel/Netlify (å‰ç«¯) + Railway (åç«¯)
```

---

## ğŸ® æ¸¸æˆå¼•æ“é€‰æ‹©ï¼šPhaser 3

### ä¸ºä»€ä¹ˆé€‰æ‹© Phaser 3ï¼Ÿ

âœ… **ä¼˜åŠ¿**ï¼š
- æˆç†Ÿçš„ 2D æ¸¸æˆå¼•æ“ï¼Œä¸“ä¸ºåƒç´ æ¸¸æˆä¼˜åŒ–
- å®Œå–„çš„ç‰©ç†å¼•æ“ï¼ˆArcade Physicsï¼‰
- å†…ç½®ç²¾çµåŠ¨ç”»ã€ç²’å­ç³»ç»Ÿã€tilemap æ”¯æŒ
- æ´»è·ƒçš„ç¤¾åŒºå’Œä¸°å¯Œçš„æ–‡æ¡£
- ä¸ Vite å®Œç¾é›†æˆ
- æ”¯æŒ TypeScript
- å…è´¹å¼€æºï¼ˆMIT åè®®ï¼‰

âœ… **é€‚åˆæœ¬é¡¹ç›®çš„åŸå› **ï¼š
- åƒç´ æ¸¸æˆæ˜¯ Phaser çš„å¼ºé¡¹
- å†…ç½® Tilemap ç³»ç»Ÿé€‚åˆåœ°å›¾ç”Ÿæˆ
- ç²’å­ç³»ç»Ÿå¯ä»¥å®ç°è¿·é›¾æ•ˆæœ
- çŠ¶æ€æœºé€‚åˆæ•Œäºº AI
- æ€§èƒ½ä¼˜ç§€ï¼Œæ”¯æŒå¤§é‡ç²¾çµ

---

## ğŸ—ï¸ æ•´ä½“æ¶æ„è®¾è®¡

### æ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       æ¸¸æˆåº”ç”¨å±‚                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  React UI    â”‚  â”‚ Phaser Game  â”‚  â”‚  Zustand     â”‚ â”‚
â”‚  â”‚   Layer      â”‚  â”‚    Core      â”‚  â”‚   Store      â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚         â”‚                 â”‚                  â”‚          â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                           â”‚                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                    æ ¸å¿ƒç³»ç»Ÿå±‚                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚ æˆ˜æ–—   â”‚ â”‚ è¿·é›¾   â”‚ â”‚ åœ°å›¾   â”‚ â”‚ AI     â”‚         â”‚
â”‚  â”‚ System â”‚ â”‚ System â”‚ â”‚ System â”‚ â”‚ System â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚ è§’è‰²   â”‚ â”‚ èƒŒåŒ…   â”‚ â”‚ ä»»åŠ¡   â”‚ â”‚ å­˜æ¡£   â”‚         â”‚
â”‚  â”‚ System â”‚ â”‚ System â”‚ â”‚ System â”‚ â”‚ System â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                    æ•°æ®ä¸èµ„æºå±‚                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Game Data   â”‚  â”‚   Assets     â”‚  â”‚ LocalStorageâ”‚  â”‚
â”‚  â”‚   (JSON)     â”‚  â”‚(Sprites/SFX) â”‚  â”‚   / IndexDB â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                                     â”‚
         â–¼                                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Vite Build      â”‚              â”‚ Optional Backend    â”‚
â”‚  Development     â”‚              â”‚ (Node.js/Express)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“‚ é¡¹ç›®ç»“æ„

```
program1/
â”œâ”€â”€ public/                          # é™æ€èµ„æº
â”‚   â”œâ”€â”€ assets/                      # æ¸¸æˆèµ„æº
â”‚   â”‚   â”œâ”€â”€ sprites/                 # ç²¾çµå›¾
â”‚   â”‚   â”‚   â”œâ”€â”€ player/              # ç©å®¶åŠ¨ç”»
â”‚   â”‚   â”‚   â”œâ”€â”€ enemies/             # æ•Œäºº
â”‚   â”‚   â”‚   â”œâ”€â”€ environment/         # ç¯å¢ƒç‰©ä»¶
â”‚   â”‚   â”‚   â””â”€â”€ effects/             # ç‰¹æ•ˆ
â”‚   â”‚   â”œâ”€â”€ tilesets/                # åœ°å›¾è´´å›¾
â”‚   â”‚   â”œâ”€â”€ audio/                   # éŸ³é¢‘
â”‚   â”‚   â”‚   â”œâ”€â”€ music/               # èƒŒæ™¯éŸ³ä¹
â”‚   â”‚   â”‚   â””â”€â”€ sfx/                 # éŸ³æ•ˆ
â”‚   â”‚   â””â”€â”€ ui/                      # UIèµ„æº
â”‚   â””â”€â”€ data/                        # é…ç½®æ•°æ®
â”‚       â”œâ”€â”€ skills.json              # æŠ€èƒ½é…ç½®
â”‚       â”œâ”€â”€ enemies.json             # æ•Œäººé…ç½®
â”‚       â”œâ”€â”€ items.json               # ç‰©å“é…ç½®
â”‚       â””â”€â”€ maps/                    # åœ°å›¾æ•°æ®
â”‚
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ main.ts                      # å…¥å£æ–‡ä»¶
â”‚   â”œâ”€â”€ App.tsx                      # React æ ¹ç»„ä»¶
â”‚   â”‚
â”‚   â”œâ”€â”€ game/                        # Phaser æ¸¸æˆæ ¸å¿ƒ
â”‚   â”‚   â”œâ”€â”€ index.ts                 # æ¸¸æˆåˆå§‹åŒ–
â”‚   â”‚   â”œâ”€â”€ config.ts                # Phaser é…ç½®
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ scenes/                  # æ¸¸æˆåœºæ™¯
â”‚   â”‚   â”‚   â”œâ”€â”€ BootScene.ts         # å¯åŠ¨åœºæ™¯ï¼ˆé¢„åŠ è½½ï¼‰
â”‚   â”‚   â”‚   â”œâ”€â”€ MenuScene.ts         # ä¸»èœå•
â”‚   â”‚   â”‚   â”œâ”€â”€ GameScene.ts         # ä¸»æ¸¸æˆåœºæ™¯
â”‚   â”‚   â”‚   â”œâ”€â”€ UIScene.ts           # UIè¦†ç›–å±‚
â”‚   â”‚   â”‚   â””â”€â”€ BattleScene.ts       # æˆ˜æ–—åœºæ™¯ï¼ˆå¯é€‰ï¼‰
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ entities/                # æ¸¸æˆå®ä½“
â”‚   â”‚   â”‚   â”œâ”€â”€ Player.ts            # ç©å®¶ç±»
â”‚   â”‚   â”‚   â”œâ”€â”€ Enemy.ts             # æ•ŒäººåŸºç±»
â”‚   â”‚   â”‚   â”œâ”€â”€ Projectile.ts       # æŠ•å°„ç‰©
â”‚   â”‚   â”‚   â””â”€â”€ NPC.ts               # NPCç±»
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ systems/                 # æ¸¸æˆç³»ç»Ÿ
â”‚   â”‚   â”‚   â”œâ”€â”€ CombatSystem.ts      # æˆ˜æ–—ç³»ç»Ÿ
â”‚   â”‚   â”‚   â”œâ”€â”€ FogSystem.ts         # è¿·é›¾ç³»ç»Ÿ
â”‚   â”‚   â”‚   â”œâ”€â”€ MagicSystem.ts       # é­”æ³•ç³»ç»Ÿ
â”‚   â”‚   â”‚   â”œâ”€â”€ InventorySystem.ts   # èƒŒåŒ…ç³»ç»Ÿ
â”‚   â”‚   â”‚   â”œâ”€â”€ QuestSystem.ts       # ä»»åŠ¡ç³»ç»Ÿ
â”‚   â”‚   â”‚   â”œâ”€â”€ SkillSystem.ts       # æŠ€èƒ½ç³»ç»Ÿ
â”‚   â”‚   â”‚   â”œâ”€â”€ AISystem.ts          # AIç³»ç»Ÿ
â”‚   â”‚   â”‚   â”œâ”€â”€ MapSystem.ts         # åœ°å›¾ç³»ç»Ÿ
â”‚   â”‚   â”‚   â””â”€â”€ SaveSystem.ts        # å­˜æ¡£ç³»ç»Ÿ
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ managers/                # ç®¡ç†å™¨
â”‚   â”‚   â”‚   â”œâ”€â”€ ResourceManager.ts   # èµ„æºç®¡ç†
â”‚   â”‚   â”‚   â”œâ”€â”€ EventManager.ts      # äº‹ä»¶ç®¡ç†
â”‚   â”‚   â”‚   â”œâ”€â”€ AudioManager.ts      # éŸ³é¢‘ç®¡ç†
â”‚   â”‚   â”‚   â””â”€â”€ InputManager.ts      # è¾“å…¥ç®¡ç†
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ components/              # ECSç»„ä»¶ï¼ˆå¯é€‰ï¼‰
â”‚   â”‚   â”‚   â”œâ”€â”€ HealthComponent.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ PositionComponent.ts
â”‚   â”‚   â”‚   â””â”€â”€ AnimationComponent.ts
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â”€ utils/                   # å·¥å…·å‡½æ•°
â”‚   â”‚       â”œâ”€â”€ math.ts              # æ•°å­¦å·¥å…·
â”‚   â”‚       â”œâ”€â”€ collision.ts         # ç¢°æ’æ£€æµ‹
â”‚   â”‚       â”œâ”€â”€ pathfinding.ts       # å¯»è·¯ç®—æ³•
â”‚   â”‚       â””â”€â”€ random.ts            # éšæœºæ•°ç”Ÿæˆ
â”‚   â”‚
â”‚   â”œâ”€â”€ ui/                          # React UIç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ components/              # UIç»„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ MainMenu.tsx         # ä¸»èœå•
â”‚   â”‚   â”‚   â”œâ”€â”€ HUD.tsx              # æ¸¸æˆå†…HUD
â”‚   â”‚   â”‚   â”œâ”€â”€ Inventory.tsx        # èƒŒåŒ…ç•Œé¢
â”‚   â”‚   â”‚   â”œâ”€â”€ SkillTree.tsx        # æŠ€èƒ½æ ‘
â”‚   â”‚   â”‚   â”œâ”€â”€ Dialog.tsx           # å¯¹è¯æ¡†
â”‚   â”‚   â”‚   â””â”€â”€ Settings.tsx         # è®¾ç½®ç•Œé¢
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â”€ hooks/                   # React Hooks
â”‚   â”‚       â”œâ”€â”€ useGame.ts           # æ¸¸æˆçŠ¶æ€hook
â”‚   â”‚       â””â”€â”€ useInventory.ts      # èƒŒåŒ…hook
â”‚   â”‚
â”‚   â”œâ”€â”€ store/                       # ZustandçŠ¶æ€ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ gameStore.ts             # æ¸¸æˆå…¨å±€çŠ¶æ€
â”‚   â”‚   â”œâ”€â”€ playerStore.ts           # ç©å®¶çŠ¶æ€
â”‚   â”‚   â”œâ”€â”€ inventoryStore.ts        # èƒŒåŒ…çŠ¶æ€
â”‚   â”‚   â””â”€â”€ uiStore.ts               # UIçŠ¶æ€
â”‚   â”‚
â”‚   â”œâ”€â”€ types/                       # TypeScript ç±»å‹å®šä¹‰
â”‚   â”‚   â”œâ”€â”€ game.d.ts                # æ¸¸æˆç±»å‹
â”‚   â”‚   â”œâ”€â”€ entities.d.ts            # å®ä½“ç±»å‹
â”‚   â”‚   â”œâ”€â”€ systems.d.ts             # ç³»ç»Ÿç±»å‹
â”‚   â”‚   â””â”€â”€ data.d.ts                # æ•°æ®ç±»å‹
â”‚   â”‚
â”‚   â”œâ”€â”€ constants/                   # å¸¸é‡
â”‚   â”‚   â”œâ”€â”€ gameConfig.ts            # æ¸¸æˆé…ç½®
â”‚   â”‚   â”œâ”€â”€ keybindings.ts           # æŒ‰é”®ç»‘å®š
â”‚   â”‚   â””â”€â”€ balanceConfig.ts         # æ•°å€¼å¹³è¡¡
â”‚   â”‚
â”‚   â””â”€â”€ services/                    # å¤–éƒ¨æœåŠ¡
â”‚       â”œâ”€â”€ api.ts                   # APIè°ƒç”¨
â”‚       â””â”€â”€ analytics.ts             # æ•°æ®ç»Ÿè®¡
â”‚
â”œâ”€â”€ server/                          # åç«¯ï¼ˆå¯é€‰ï¼‰
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ index.ts                 # æœåŠ¡å™¨å…¥å£
â”‚   â”‚   â”œâ”€â”€ routes/                  # APIè·¯ç”±
â”‚   â”‚   â”‚   â”œâ”€â”€ leaderboard.ts       # æ’è¡Œæ¦œ
â”‚   â”‚   â”‚   â””â”€â”€ save.ts              # äº‘å­˜æ¡£
â”‚   â”‚   â””â”€â”€ db/                      # æ•°æ®åº“
â”‚   â”‚       â””â”€â”€ schema.sql           # æ•°æ®è¡¨ç»“æ„
â”‚   â”‚
â”‚   â””â”€â”€ package.json
â”‚
â”œâ”€â”€ tests/                           # æµ‹è¯•
â”‚   â”œâ”€â”€ unit/                        # å•å…ƒæµ‹è¯•
â”‚   â””â”€â”€ integration/                 # é›†æˆæµ‹è¯•
â”‚
â”œâ”€â”€ tools/                           # å¼€å‘å·¥å…·
â”‚   â”œâ”€â”€ mapEditor/                   # åœ°å›¾ç¼–è¾‘å™¨
â”‚   â””â”€â”€ dataValidator/               # æ•°æ®éªŒè¯å™¨
â”‚
â”œâ”€â”€ index.html                       # HTMLå…¥å£
â”œâ”€â”€ package.json                     # é¡¹ç›®ä¾èµ–
â”œâ”€â”€ tsconfig.json                    # TSé…ç½®
â”œâ”€â”€ vite.config.ts                   # Viteé…ç½®
â””â”€â”€ README.md                        # é¡¹ç›®è¯´æ˜
```

---

## ğŸ”§ æŠ€æœ¯æ ˆè¯¦ç»†é…ç½®

### 1. å‰ç«¯æ ¸å¿ƒæŠ€æœ¯

#### 1.1 Vite é…ç½®

```typescript
// vite.config.ts
import { defineConfig } from 'vite';
import react from '@vitejs/plugin-react';
import path from 'path';

export default defineConfig({
  plugins: [react()],
  resolve: {
    alias: {
      '@': path.resolve(__dirname, './src'),
      '@game': path.resolve(__dirname, './src/game'),
      '@ui': path.resolve(__dirname, './src/ui'),
      '@assets': path.resolve(__dirname, './public/assets'),
    },
  },
  server: {
    port: 3000,
    open: true,
  },
  build: {
    target: 'esnext',
    minify: 'terser',
    rollupOptions: {
      output: {
        manualChunks: {
          phaser: ['phaser'],
          react: ['react', 'react-dom'],
        },
      },
    },
  },
});
```

#### 1.2 TypeScript é…ç½®

```json
// tsconfig.json
{
  "compilerOptions": {
    "target": "ES2020",
    "useDefineForClassFields": true,
    "lib": ["ES2020", "DOM", "DOM.Iterable"],
    "module": "ESNext",
    "skipLibCheck": true,
    "moduleResolution": "bundler",
    "allowImportingTsExtensions": true,
    "resolveJsonModule": true,
    "isolatedModules": true,
    "noEmit": true,
    "jsx": "react-jsx",
    "strict": true,
    "noUnusedLocals": true,
    "noUnusedParameters": true,
    "noFallthroughCasesInSwitch": true,
    "baseUrl": ".",
    "paths": {
      "@/*": ["src/*"],
      "@game/*": ["src/game/*"],
      "@ui/*": ["src/ui/*"],
      "@assets/*": ["public/assets/*"]
    }
  },
  "include": ["src"],
  "references": [{ "path": "./tsconfig.node.json" }]
}
```

#### 1.3 ä¾èµ–åŒ…

```json
// package.json
{
  "name": "forgotten-pixel-realm",
  "version": "0.1.0",
  "type": "module",
  "scripts": {
    "dev": "vite",
    "build": "tsc && vite build",
    "preview": "vite preview",
    "test": "vitest",
    "lint": "eslint . --ext ts,tsx --report-unused-disable-directives --max-warnings 0"
  },
  "dependencies": {
    "phaser": "^3.80.1",
    "react": "^18.2.0",
    "react-dom": "^18.2.0",
    "zustand": "^4.4.7",
    "immer": "^10.0.3",
    "uuid": "^9.0.1"
  },
  "devDependencies": {
    "@types/react": "^18.2.43",
    "@types/react-dom": "^18.2.17",
    "@vitejs/plugin-react": "^4.2.1",
    "typescript": "^5.3.3",
    "vite": "^5.0.8",
    "vitest": "^1.0.4",
    "eslint": "^8.55.0",
    "@typescript-eslint/eslint-plugin": "^6.14.0",
    "@typescript-eslint/parser": "^6.14.0",
    "tailwindcss": "^3.4.0",
    "autoprefixer": "^10.4.16",
    "postcss": "^8.4.32"
  }
}
```

---

## ğŸ¯ æ ¸å¿ƒç³»ç»Ÿæ¶æ„

### 1. Phaser æ¸¸æˆåˆå§‹åŒ–

```typescript
// src/game/index.ts
import Phaser from 'phaser';
import { BootScene } from './scenes/BootScene';
import { MenuScene } from './scenes/MenuScene';
import { GameScene } from './scenes/GameScene';
import { UIScene } from './scenes/UIScene';

export class Game {
  private game: Phaser.Game;

  constructor(parent: string) {
    const config: Phaser.Types.Core.GameConfig = {
      type: Phaser.AUTO,
      width: 1280,
      height: 720,
      parent,
      backgroundColor: '#2d2d2d',
      pixelArt: true, // å…³é”®ï¼šåƒç´ æ¸¸æˆå¿…é¡»å¼€å¯
      antialias: false,
      roundPixels: true,
      physics: {
        default: 'arcade',
        arcade: {
          gravity: { x: 0, y: 0 }, // ä¿¯è§†è§’æ— é‡åŠ›
          debug: process.env.NODE_ENV === 'development',
        },
      },
      scene: [BootScene, MenuScene, GameScene, UIScene],
      scale: {
        mode: Phaser.Scale.FIT,
        autoCenter: Phaser.Scale.CENTER_BOTH,
      },
    };

    this.game = new Phaser.Game(config);
  }

  destroy() {
    this.game.destroy(true);
  }
}
```

### 2. åœºæ™¯ç®¡ç†

#### GameScene ä¸»æ¸¸æˆåœºæ™¯

```typescript
// src/game/scenes/GameScene.ts
import Phaser from 'phaser';
import { Player } from '../entities/Player';
import { FogSystem } from '../systems/FogSystem';
import { CombatSystem } from '../systems/CombatSystem';

export class GameScene extends Phaser.Scene {
  private player!: Player;
  private fogSystem!: FogSystem;
  private combatSystem!: CombatSystem;
  private map!: Phaser.Tilemaps.Tilemap;

  constructor() {
    super({ key: 'GameScene' });
  }

  create() {
    // åˆ›å»ºåœ°å›¾
    this.createMap();
    
    // åˆ›å»ºç©å®¶
    this.player = new Player(this, 400, 300);
    
    // åˆå§‹åŒ–ç³»ç»Ÿ
    this.fogSystem = new FogSystem(this);
    this.combatSystem = new CombatSystem(this);
    
    // ç›¸æœºè·Ÿéš
    this.cameras.main.startFollow(this.player, true, 0.1, 0.1);
    this.cameras.main.setZoom(2); // æ”¾å¤§æ˜¾ç¤ºåƒç´ 
  }

  update(time: number, delta: number) {
    this.player.update(time, delta);
    this.fogSystem.update(time, delta);
    this.combatSystem.update(time, delta);
  }

  private createMap() {
    // åŠ è½½Tilemap
    this.map = this.make.tilemap({ key: 'map-forest' });
    const tileset = this.map.addTilesetImage('terrain', 'tiles-terrain');
    
    // åˆ›å»ºå›¾å±‚
    const groundLayer = this.map.createLayer('Ground', tileset!);
    const wallLayer = this.map.createLayer('Walls', tileset!);
    
    // è®¾ç½®ç¢°æ’
    wallLayer?.setCollisionByProperty({ collides: true });
  }
}
```

### 3. å®ä½“ç³»ç»Ÿï¼ˆç©å®¶ç¤ºä¾‹ï¼‰

```typescript
// src/game/entities/Player.ts
import Phaser from 'phaser';

export class Player extends Phaser.Physics.Arcade.Sprite {
  private cursors!: Phaser.Types.Input.Keyboard.CursorKeys;
  private speed = 100;
  private health = 100;
  private maxHealth = 100;
  private mana = 80;
  private maxMana = 80;

  constructor(scene: Phaser.Scene, x: number, y: number) {
    super(scene, x, y, 'player', 0);
    
    scene.add.existing(this);
    scene.physics.add.existing(this);
    
    this.setCollideWorldBounds(true);
    this.createAnimations();
    this.setupInput();
  }

  private createAnimations() {
    // è¡Œèµ°åŠ¨ç”»ï¼ˆ4æ–¹å‘ï¼‰
    this.anims.create({
      key: 'walk-down',
      frames: this.anims.generateFrameNumbers('player', { start: 0, end: 3 }),
      frameRate: 8,
      repeat: -1,
    });
    
    this.anims.create({
      key: 'walk-up',
      frames: this.anims.generateFrameNumbers('player', { start: 4, end: 7 }),
      frameRate: 8,
      repeat: -1,
    });
    
    // ... å…¶ä»–æ–¹å‘
  }

  private setupInput() {
    this.cursors = this.scene.input.keyboard!.createCursorKeys();
  }

  update(time: number, delta: number) {
    // ç§»åŠ¨é€»è¾‘
    let velocityX = 0;
    let velocityY = 0;

    if (this.cursors.left.isDown) velocityX = -this.speed;
    else if (this.cursors.right.isDown) velocityX = this.speed;

    if (this.cursors.up.isDown) velocityY = -this.speed;
    else if (this.cursors.down.isDown) velocityY = this.speed;

    // æ ‡å‡†åŒ–å¯¹è§’çº¿é€Ÿåº¦
    if (velocityX !== 0 && velocityY !== 0) {
      velocityX *= 0.707;
      velocityY *= 0.707;
    }

    this.setVelocity(velocityX, velocityY);

    // æ’­æ”¾åŠ¨ç”»
    if (velocityY > 0) this.anims.play('walk-down', true);
    else if (velocityY < 0) this.anims.play('walk-up', true);
    else if (velocityX !== 0) this.anims.play('walk-side', true);
    else this.anims.stop();
  }

  takeDamage(amount: number) {
    this.health = Math.max(0, this.health - amount);
    // è§¦å‘å—ä¼¤æ•ˆæœ
    this.scene.events.emit('player-damaged', this.health);
  }

  heal(amount: number) {
    this.health = Math.min(this.maxHealth, this.health + amount);
  }
}
```

### 4. è¿·é›¾ç³»ç»Ÿ

```typescript
// src/game/systems/FogSystem.ts
import Phaser from 'phaser';

export class FogSystem {
  private scene: Phaser.Scene;
  private fogLayer!: Phaser.GameObjects.RenderTexture;
  private exploredMap: Set<string> = new Set();
  private fogDensity = 0.8; // è¿·é›¾å¯†åº¦

  constructor(scene: Phaser.Scene) {
    this.scene = scene;
    this.createFogLayer();
  }

  private createFogLayer() {
    const { width, height } = this.scene.sys.game.config;
    
    // åˆ›å»ºæ¸²æŸ“çº¹ç†ä½œä¸ºè¿·é›¾é®ç½©
    this.fogLayer = this.scene.add.renderTexture(
      0, 0, 
      Number(width) * 2, 
      Number(height) * 2
    );
    
    // åˆå§‹åŒ–ä¸ºå®Œå…¨è¿·é›¾
    this.fogLayer.fill(0x000000, this.fogDensity);
    this.fogLayer.setDepth(1000); // ç½®äºé¡¶å±‚
  }

  /**
   * æ¸…é™¤æŒ‡å®šä½ç½®çš„è¿·é›¾
   */
  clearFog(x: number, y: number, radius: number) {
    // ä½¿ç”¨åœ†å½¢é®ç½©æ¸…é™¤è¿·é›¾
    const graphics = this.scene.make.graphics({});
    graphics.fillStyle(0x000000);
    graphics.fillCircle(x, y, radius);
    
    this.fogLayer.erase(graphics, x - radius, y - radius);
    graphics.destroy();
    
    // è®°å½•å·²æ¢ç´¢åŒºåŸŸ
    const gridX = Math.floor(x / 16);
    const gridY = Math.floor(y / 16);
    this.exploredMap.add(`${gridX},${gridY}`);
  }

  /**
   * è¿·é›¾å†ç”Ÿï¼ˆé«˜çº§åŠŸèƒ½ï¼‰
   */
  regenerateFog(x: number, y: number, radius: number) {
    const graphics = this.scene.make.graphics({});
    graphics.fillStyle(0x000000, this.fogDensity * 0.5); // åŠå¼ºåº¦å†ç”Ÿ
    graphics.fillCircle(x, y, radius);
    
    this.fogLayer.draw(graphics, x - radius, y - radius);
    graphics.destroy();
  }

  update(time: number, delta: number) {
    // æ¯å¸§æ›´æ–°è¿·é›¾ï¼ˆå¦‚åŠ¨æ€è¿·é›¾ï¼‰
    // å¯ä»¥æ·»åŠ å‘¼å¸æ•ˆæœã€æµåŠ¨æ•ˆæœç­‰
  }

  isExplored(x: number, y: number): boolean {
    const gridX = Math.floor(x / 16);
    const gridY = Math.floor(y / 16);
    return this.exploredMap.has(`${gridX},${gridY}`);
  }
}
```

### 5. é­”æ³•ç³»ç»Ÿ

```typescript
// src/game/systems/MagicSystem.ts
import Phaser from 'phaser';
import { Player } from '../entities/Player';

interface Skill {
  id: string;
  name: string;
  element: 'fire' | 'ice' | 'thunder' | 'nature';
  manaCost: number;
  cooldown: number;
  effect: (target: Phaser.Math.Vector2) => void;
}

export class MagicSystem {
  private scene: Phaser.Scene;
  private player: Player;
  private skills: Map<string, Skill> = new Map();
  private cooldowns: Map<string, number> = new Map();
  private lastCastTime: Map<string, number> = new Map();

  constructor(scene: Phaser.Scene, player: Player) {
    this.scene = scene;
    this.player = player;
    this.loadSkills();
  }

  private loadSkills() {
    // ç«çƒæœ¯
    this.skills.set('fireball', {
      id: 'fireball',
      name: 'ç«çƒæœ¯',
      element: 'fire',
      manaCost: 10,
      cooldown: 1000, // 1ç§’å†·å´
      effect: (target) => this.castFireball(target),
    });

    // å†°éœœæ–°æ˜Ÿ
    this.skills.set('frostnova', {
      id: 'frostnova',
      name: 'å†°éœœæ–°æ˜Ÿ',
      element: 'ice',
      manaCost: 15,
      cooldown: 3000,
      effect: (target) => this.castFrostNova(target),
    });
  }

  castSkill(skillId: string, target: Phaser.Math.Vector2): boolean {
    const skill = this.skills.get(skillId);
    if (!skill) return false;

    // æ£€æŸ¥å†·å´
    const now = this.scene.time.now;
    const lastCast = this.lastCastTime.get(skillId) || 0;
    if (now - lastCast < skill.cooldown) return false;

    // æ£€æŸ¥é­”åŠ›
    if (this.player.mana < skill.manaCost) return false;

    // æ–½æ”¾æŠ€èƒ½
    skill.effect(target);
    this.player.mana -= skill.manaCost;
    this.lastCastTime.set(skillId, now);

    return true;
  }

  private castFireball(target: Phaser.Math.Vector2) {
    // åˆ›å»ºç«çƒæŠ•å°„ç‰©
    const fireball = this.scene.physics.add.sprite(
      this.player.x,
      this.player.y,
      'fireball'
    );
    
    fireball.setScale(2);
    
    // è®¡ç®—æ–¹å‘
    const angle = Phaser.Math.Angle.Between(
      this.player.x,
      this.player.y,
      target.x,
      target.y
    );
    
    // è®¾ç½®é€Ÿåº¦
    this.scene.physics.velocityFromRotation(
      angle,
      300,
      fireball.body!.velocity
    );
    
    // 3ç§’åé”€æ¯
    this.scene.time.delayedCall(3000, () => fireball.destroy());
  }

  private castFrostNova(target: Phaser.Math.Vector2) {
    // AOEå†°éœœæ•ˆæœ
    const radius = 100;
    const graphics = this.scene.add.graphics();
    
    graphics.fillStyle(0x00ffff, 0.3);
    graphics.fillCircle(this.player.x, this.player.y, radius);
    
    // 0.5ç§’åæ¶ˆå¤±
    this.scene.time.delayedCall(500, () => graphics.destroy());
    
    // å¯¹èŒƒå›´å†…æ•Œäººé€ æˆä¼¤å®³å’Œå‡é€Ÿ
    // ... ä¼¤å®³é€»è¾‘
  }

  /**
   * é­”æ³•èåˆç³»ç»Ÿï¼ˆé«˜çº§ï¼‰
   */
  tryFusion(skill1: string, skill2: string): string | null {
    const fusionMap: Record<string, string> = {
      'fireball+frostnova': 'steam_explosion',
      'fireball+lightning': 'plasma_ball',
      // ... æ›´å¤šç»„åˆ
    };
    
    const key1 = `${skill1}+${skill2}`;
    const key2 = `${skill2}+${skill1}`;
    
    return fusionMap[key1] || fusionMap[key2] || null;
  }
}
```

### 6. çŠ¶æ€ç®¡ç†ï¼ˆZustandï¼‰

```typescript
// src/store/gameStore.ts
import { create } from 'zustand';
import { immer } from 'zustand/middleware/immer';

interface GameState {
  isPlaying: boolean;
  isPaused: boolean;
  currentScene: string;
  
  // ç©å®¶æ•°æ®
  player: {
    level: number;
    exp: number;
    health: number;
    maxHealth: number;
    mana: number;
    maxMana: number;
    skills: string[];
  };
  
  // èƒŒåŒ…
  inventory: {
    items: Item[];
    maxSlots: number;
  };
  
  // ä»»åŠ¡
  quests: Quest[];
  
  // æ¸¸æˆè¿›åº¦
  progress: {
    exploredAreas: string[];
    killedBosses: string[];
    unlockedSkills: string[];
  };
  
  // Actions
  startGame: () => void;
  pauseGame: () => void;
  saveGame: () => void;
  loadGame: (saveData: any) => void;
}

export const useGameStore = create<GameState>()(
  immer((set, get) => ({
    isPlaying: false,
    isPaused: false,
    currentScene: 'menu',
    
    player: {
      level: 1,
      exp: 0,
      health: 100,
      maxHealth: 100,
      mana: 80,
      maxMana: 80,
      skills: ['fireball'],
    },
    
    inventory: {
      items: [],
      maxSlots: 20,
    },
    
    quests: [],
    
    progress: {
      exploredAreas: [],
      killedBosses: [],
      unlockedSkills: ['fireball'],
    },
    
    startGame: () => set({ isPlaying: true, currentScene: 'game' }),
    
    pauseGame: () => set((state) => {
      state.isPaused = !state.isPaused;
    }),
    
    saveGame: () => {
      const state = get();
      const saveData = {
        player: state.player,
        inventory: state.inventory,
        quests: state.quests,
        progress: state.progress,
        timestamp: Date.now(),
      };
      localStorage.setItem('game-save', JSON.stringify(saveData));
    },
    
    loadGame: (saveData) => set((state) => {
      Object.assign(state, saveData);
    }),
  }))
);
```

### 7. React UI é›†æˆ

```typescript
// src/ui/components/HUD.tsx
import React from 'react';
import { useGameStore } from '@/store/gameStore';

export const HUD: React.FC = () => {
  const player = useGameStore((state) => state.player);
  
  return (
    <div className="fixed inset-0 pointer-events-none">
      {/* å·¦ä¸Šè§’ï¼šç”Ÿå‘½å’Œé­”åŠ› */}
      <div className="absolute top-4 left-4 pointer-events-auto">
        <div className="bg-black/50 p-3 rounded-lg border border-white/20">
          {/* ç”Ÿå‘½æ¡ */}
          <div className="mb-2">
            <div className="flex items-center gap-2 mb-1">
              <span className="text-red-400 text-sm">â¤ï¸ HP</span>
              <span className="text-white text-sm">
                {player.health}/{player.maxHealth}
              </span>
            </div>
            <div className="w-48 h-2 bg-gray-700 rounded-full overflow-hidden">
              <div
                className="h-full bg-red-500 transition-all"
                style={{ width: `${(player.health / player.maxHealth) * 100}%` }}
              />
            </div>
          </div>
          
          {/* é­”åŠ›æ¡ */}
          <div>
            <div className="flex items-center gap-2 mb-1">
              <span className="text-blue-400 text-sm">ğŸ’§ MP</span>
              <span className="text-white text-sm">
                {player.mana}/{player.maxMana}
              </span>
            </div>
            <div className="w-48 h-2 bg-gray-700 rounded-full overflow-hidden">
              <div
                className="h-full bg-blue-500 transition-all"
                style={{ width: `${(player.mana / player.maxMana) * 100}%` }}
              />
            </div>
          </div>
        </div>
      </div>
      
      {/* å³ä¸‹è§’ï¼šæŠ€èƒ½æ  */}
      <div className="absolute bottom-4 right-4 flex gap-2 pointer-events-auto">
        {player.skills.map((skill, i) => (
          <div
            key={skill}
            className="w-12 h-12 bg-gray-800 rounded border-2 border-white/30
                       flex items-center justify-center cursor-pointer
                       hover:border-yellow-400 transition-colors"
          >
            <span className="text-xs text-white">{i + 1}</span>
          </div>
        ))}
      </div>
    </div>
  );
};
```

---

## ğŸ’¾ æ•°æ®å­˜å‚¨æ–¹æ¡ˆ

### 1. æœ¬åœ°å­˜å‚¨ï¼ˆLocalStorageï¼‰

```typescript
// src/game/systems/SaveSystem.ts
export class SaveSystem {
  private static SAVE_KEY = 'forgotten-pixel-realm-save';
  
  static save(data: SaveData): void {
    const saveData = {
      version: '1.0.0',
      timestamp: Date.now(),
      data,
    };
    localStorage.setItem(this.SAVE_KEY, JSON.stringify(saveData));
  }
  
  static load(): SaveData | null {
    const saved = localStorage.getItem(this.SAVE_KEY);
    if (!saved) return null;
    
    try {
      const { data } = JSON.parse(saved);
      return data;
    } catch (error) {
      console.error('Failed to load save:', error);
      return null;
    }
  }
  
  static delete(): void {
    localStorage.removeItem(this.SAVE_KEY);
  }
  
  static exists(): boolean {
    return localStorage.getItem(this.SAVE_KEY) !== null;
  }
}

interface SaveData {
  player: PlayerData;
  inventory: InventoryData;
  progress: ProgressData;
  settings: SettingsData;
}
```

### 2. IndexedDBï¼ˆå¤§é‡æ•°æ®ï¼‰

```typescript
// src/services/database.ts
import { openDB, DBSchema, IDBPDatabase } from 'idb';

interface GameDB extends DBSchema {
  saves: {
    key: string;
    value: SaveData;
  };
  achievements: {
    key: string;
    value: Achievement;
  };
}

class Database {
  private db!: IDBPDatabase<GameDB>;
  
  async init() {
    this.db = await openDB<GameDB>('game-db', 1, {
      upgrade(db) {
        db.createObjectStore('saves');
        db.createObjectStore('achievements');
      },
    });
  }
  
  async saveSave(id: string, data: SaveData) {
    await this.db.put('saves', data, id);
  }
  
  async loadSave(id: string) {
    return await this.db.get('saves', id);
  }
  
  async getAllSaves() {
    return await this.db.getAll('saves');
  }
}

export const db = new Database();
```

### 3. äº‘å­˜æ¡£ï¼ˆå¯é€‰åç«¯ï¼‰

```typescript
// server/src/routes/save.ts
import express from 'express';
import { db } from '../db';

const router = express.Router();

// ä¸Šä¼ å­˜æ¡£
router.post('/save', async (req, res) => {
  const { userId, saveData } = req.body;
  
  try {
    await db.query(
      'INSERT INTO saves (user_id, data, updated_at) VALUES (?, ?, NOW())',
      [userId, JSON.stringify(saveData)]
    );
    res.json({ success: true });
  } catch (error) {
    res.status(500).json({ error: 'Failed to save' });
  }
});

// ä¸‹è½½å­˜æ¡£
router.get('/save/:userId', async (req, res) => {
  const { userId } = req.params;
  
  try {
    const [rows] = await db.query(
      'SELECT data FROM saves WHERE user_id = ? ORDER BY updated_at DESC LIMIT 1',
      [userId]
    );
    res.json({ data: rows[0]?.data });
  } catch (error) {
    res.status(500).json({ error: 'Failed to load' });
  }
});

export default router;
```

---

## ğŸ¨ èµ„æºç®¡ç†

### èµ„æºåŠ è½½ç­–ç•¥

```typescript
// src/game/managers/ResourceManager.ts
export class ResourceManager {
  private scene: Phaser.Scene;
  private loadedAssets: Set<string> = new Set();
  
  constructor(scene: Phaser.Scene) {
    this.scene = scene;
  }
  
  /**
   * é¢„åŠ è½½æ ¸å¿ƒèµ„æº
   */
  preloadCore() {
    // ç©å®¶
    this.scene.load.spritesheet('player', '/assets/sprites/player.png', {
      frameWidth: 16,
      frameHeight: 24,
    });
    
    // UI
    this.scene.load.image('ui-panel', '/assets/ui/panel.png');
    
    // éŸ³æ•ˆ
    this.scene.load.audio('step', '/assets/audio/sfx/step.mp3');
  }
  
  /**
   * æŒ‰éœ€åŠ è½½åŒºåŸŸèµ„æº
   */
  async loadArea(areaId: string) {
    if (this.loadedAssets.has(areaId)) return;
    
    // åŠ¨æ€åŠ è½½è¯¥åŒºåŸŸçš„èµ„æº
    switch (areaId) {
      case 'forest':
        this.scene.load.tilemapTiledJSON('map-forest', '/data/maps/forest.json');
        this.scene.load.image('tiles-forest', '/assets/tilesets/forest.png');
        break;
      
      case 'mine':
        this.scene.load.tilemapTiledJSON('map-mine', '/data/maps/mine.json');
        this.scene.load.image('tiles-mine', '/assets/tilesets/mine.png');
        break;
    }
    
    await this.scene.load.start();
    this.loadedAssets.add(areaId);
  }
  
  /**
   * å¸è½½ä¸ç”¨çš„èµ„æºï¼ˆä¼˜åŒ–å†…å­˜ï¼‰
   */
  unloadArea(areaId: string) {
    // ç§»é™¤çº¹ç†å’Œç¼“å­˜
    this.scene.textures.remove(`tiles-${areaId}`);
    this.loadedAssets.delete(areaId);
  }
}
```

---

## ğŸš€ æ€§èƒ½ä¼˜åŒ–ç­–ç•¥

### 1. å¯¹è±¡æ± 

```typescript
// src/game/utils/ObjectPool.ts
export class ObjectPool<T extends Phaser.GameObjects.GameObject> {
  private pool: T[] = [];
  private creator: () => T;
  
  constructor(creator: () => T, initialSize = 10) {
    this.creator = creator;
    
    // é¢„åˆ›å»ºå¯¹è±¡
    for (let i = 0; i < initialSize; i++) {
      const obj = creator();
      obj.setActive(false).setVisible(false);
      this.pool.push(obj);
    }
  }
  
  get(): T {
    let obj = this.pool.find(o => !o.active);
    
    if (!obj) {
      obj = this.creator();
      this.pool.push(obj);
    }
    
    obj.setActive(true).setVisible(true);
    return obj;
  }
  
  release(obj: T) {
    obj.setActive(false).setVisible(false);
  }
}

// ä½¿ç”¨ç¤ºä¾‹
const projectilePool = new ObjectPool(() => 
  scene.add.sprite(0, 0, 'projectile')
);

// è·å–å¯¹è±¡
const projectile = projectilePool.get();
projectile.setPosition(x, y);

// é‡Šæ”¾å¯¹è±¡
projectilePool.release(projectile);
```

### 2. è§†é‡å‰”é™¤

```typescript
// src/game/systems/CullingSystem.ts
export class CullingSystem {
  private camera: Phaser.Cameras.Scene2D.Camera;
  private entities: Phaser.GameObjects.GameObject[] = [];
  
  constructor(camera: Phaser.Cameras.Scene2D.Camera) {
    this.camera = camera;
  }
  
  register(entity: Phaser.GameObjects.GameObject) {
    this.entities.push(entity);
  }
  
  update() {
    const bounds = this.camera.worldView;
    
    for (const entity of this.entities) {
      const inView = Phaser.Geom.Rectangle.Overlaps(
        bounds,
        (entity as any).getBounds()
      );
      
      entity.setActive(inView);
      
      // è§†é‡å¤–çš„æ•Œäººæš‚åœæ›´æ–°
      if (!inView && 'pauseAI' in entity) {
        (entity as any).pauseAI();
      }
    }
  }
}
```

### 3. çº¹ç†å›¾é›†

ä½¿ç”¨å·¥å…·ï¼ˆå¦‚TexturePackerï¼‰å°†å¤šä¸ªå°å›¾åˆæˆä¸€å¼ å¤§å›¾ï¼š

```json
// public/assets/sprites/atlas.json
{
  "frames": {
    "player-walk-0": { "frame": {"x":0,"y":0,"w":16,"h":24} },
    "player-walk-1": { "frame": {"x":16,"y":0,"w":16,"h":24} },
    "enemy-slime-0": { "frame": {"x":32,"y":0,"w":16,"h":16} }
  }
}
```

```typescript
// åŠ è½½å›¾é›†
this.load.atlas('game-atlas', '/assets/sprites/atlas.png', '/assets/sprites/atlas.json');

// ä½¿ç”¨
this.add.sprite(x, y, 'game-atlas', 'player-walk-0');
```

---

## ğŸ“± éƒ¨ç½²æ–¹æ¡ˆ

### 1. å‰ç«¯éƒ¨ç½²ï¼ˆVercelï¼‰

```bash
# å®‰è£… Vercel CLI
npm install -g vercel

# éƒ¨ç½²
vercel --prod
```

```json
// vercel.json
{
  "buildCommand": "npm run build",
  "outputDirectory": "dist",
  "devCommand": "npm run dev",
  "installCommand": "npm install"
}
```

### 2. åç«¯éƒ¨ç½²ï¼ˆRailwayï¼‰

```yaml
# railway.toml
[build]
builder = "NIXPACKS"

[deploy]
startCommand = "npm start"
restartPolicyType = "ON_FAILURE"
restartPolicyMaxRetries = 10
```

### 3. CDN ä¼˜åŒ–

- ä½¿ç”¨ Cloudflare CDN åŠ é€Ÿé™æ€èµ„æº
- å›¾ç‰‡ä½¿ç”¨ WebP æ ¼å¼
- å¯ç”¨ Gzip/Brotli å‹ç¼©

---

## ğŸ› ï¸ å¼€å‘å·¥å…·

### 1. åœ°å›¾ç¼–è¾‘å™¨ï¼šTiled

- ä¸‹è½½ï¼šhttps://www.mapeditor.org/
- å¯¼å‡ºä¸º JSON æ ¼å¼
- Phaser åŸç”Ÿæ”¯æŒ

### 2. åƒç´ ç»˜å›¾ï¼šAseprite

```bash
# å®‰è£…ï¼ˆmacOSï¼‰
brew install --cask aseprite

# å¯¼å‡ºsprite sheet
aseprite -b player.ase --sheet player.png --data player.json
```

### 3. è°ƒè¯•å·¥å…·

```typescript
// src/game/utils/Debug.ts
export class DebugPanel {
  private scene: Phaser.Scene;
  private text!: Phaser.GameObjects.Text;
  
  constructor(scene: Phaser.Scene) {
    this.scene = scene;
    this.create();
  }
  
  private create() {
    this.text = this.scene.add.text(10, 10, '', {
      fontSize: '12px',
      color: '#00ff00',
      backgroundColor: '#000000',
      padding: { x: 5, y: 5 },
    });
    this.text.setScrollFactor(0); // å›ºå®šåœ¨ç›¸æœº
    this.text.setDepth(10000);
  }
  
  update(player: Player) {
    this.text.setText([
      `FPS: ${Math.round(this.scene.game.loop.actualFps)}`,
      `Player: (${Math.round(player.x)}, ${Math.round(player.y)})`,
      `Health: ${player.health}/${player.maxHealth}`,
      `Entities: ${this.scene.children.length}`,
    ]);
  }
}
```

---

## ğŸ§ª æµ‹è¯•ç­–ç•¥

### å•å…ƒæµ‹è¯•ï¼ˆVitestï¼‰

```typescript
// tests/unit/MagicSystem.test.ts
import { describe, it, expect } from 'vitest';
import { MagicSystem } from '@/game/systems/MagicSystem';

describe('MagicSystem', () => {
  it('should cast fireball when mana is sufficient', () => {
    const magic = new MagicSystem(mockScene, mockPlayer);
    const result = magic.castSkill('fireball', new Vector2(100, 100));
    expect(result).toBe(true);
  });
  
  it('should not cast when on cooldown', () => {
    const magic = new MagicSystem(mockScene, mockPlayer);
    magic.castSkill('fireball', new Vector2(100, 100));
    const result = magic.castSkill('fireball', new Vector2(100, 100));
    expect(result).toBe(false);
  });
});
```

### é›†æˆæµ‹è¯•

```typescript
// tests/integration/combat.test.ts
describe('Combat System Integration', () => {
  it('player should damage enemy on hit', () => {
    const scene = createMockScene();
    const player = new Player(scene, 0, 0);
    const enemy = new Enemy(scene, 50, 50);
    
    // æ¨¡æ‹Ÿæ”»å‡»
    player.attack(enemy);
    
    expect(enemy.health).toBeLessThan(enemy.maxHealth);
  });
});
```

---

## ğŸ“Š æ€§èƒ½ç›‘æ§

### å¸§ç‡ç›‘æ§

```typescript
// src/game/utils/PerformanceMonitor.ts
export class PerformanceMonitor {
  private fpsHistory: number[] = [];
  private maxHistory = 60;
  
  update(fps: number) {
    this.fpsHistory.push(fps);
    if (this.fpsHistory.length > this.maxHistory) {
      this.fpsHistory.shift();
    }
  }
  
  getAverageFPS(): number {
    const sum = this.fpsHistory.reduce((a, b) => a + b, 0);
    return sum / this.fpsHistory.length;
  }
  
  getMinFPS(): number {
    return Math.min(...this.fpsHistory);
  }
  
  // å‘é€åˆ°åˆ†ææœåŠ¡
  report() {
    const data = {
      avgFPS: this.getAverageFPS(),
      minFPS: this.getMinFPS(),
      timestamp: Date.now(),
    };
    
    // å‘é€åˆ°åç«¯
    fetch('/api/analytics', {
      method: 'POST',
      body: JSON.stringify(data),
    });
  }
}
```

---

## ğŸ¯ å…³é”®å®ç°è¦ç‚¹

### 1. åƒç´ å®Œç¾æ¸²æŸ“

```typescript
// ç¡®ä¿åƒç´ å®Œç¾
const config: Phaser.Types.Core.GameConfig = {
  pixelArt: true,
  antialias: false,
  roundPixels: true,
};

// ç›¸æœºç¼©æ”¾ä½¿ç”¨æ•´æ•°å€
camera.setZoom(2); // æˆ– 3, 4
```

### 2. è¾“å…¥ç³»ç»Ÿ

```typescript
// src/game/managers/InputManager.ts
export class InputManager {
  private scene: Phaser.Scene;
  private keys: Map<string, Phaser.Input.Keyboard.Key> = new Map();
  
  constructor(scene: Phaser.Scene) {
    this.scene = scene;
    this.setupKeys();
  }
  
  private setupKeys() {
    const keyConfig = {
      up: 'W',
      down: 'S',
      left: 'A',
      right: 'D',
      skill1: 'ONE',
      skill2: 'TWO',
      skill3: 'THREE',
      skill4: 'FOUR',
      interact: 'E',
      inventory: 'I',
      menu: 'ESC',
    };
    
    for (const [action, key] of Object.entries(keyConfig)) {
      this.keys.set(action, this.scene.input.keyboard!.addKey(key));
    }
  }
  
  isDown(action: string): boolean {
    return this.keys.get(action)?.isDown || false;
  }
  
  onPress(action: string, callback: () => void) {
    this.keys.get(action)?.on('down', callback);
  }
}
```

### 3. äº‹ä»¶ç³»ç»Ÿ

```typescript
// src/game/managers/EventManager.ts
export class EventManager {
  private static instance: EventManager;
  private emitter: Phaser.Events.EventEmitter;
  
  private constructor() {
    this.emitter = new Phaser.Events.EventEmitter();
  }
  
  static getInstance(): EventManager {
    if (!EventManager.instance) {
      EventManager.instance = new EventManager();
    }
    return EventManager.instance;
  }
  
  emit(event: string, ...args: any[]) {
    this.emitter.emit(event, ...args);
  }
  
  on(event: string, callback: Function, context?: any) {
    this.emitter.on(event, callback, context);
  }
  
  off(event: string, callback?: Function) {
    this.emitter.off(event, callback);
  }
}

// ä½¿ç”¨
EventManager.getInstance().emit('player-level-up', { level: 5 });
EventManager.getInstance().on('player-level-up', (data) => {
  console.log('Level up to', data.level);
});
```

---

## ğŸ“ˆ å¼€å‘æµç¨‹å»ºè®®

### ç¬¬ä¸€å‘¨ï¼šç¯å¢ƒæ­å»º
- [x] åˆå§‹åŒ– Vite + React + TypeScript
- [ ] é›†æˆ Phaser 3
- [ ] åˆ›å»ºåŸºç¡€é¡¹ç›®ç»“æ„
- [ ] å®ç°ç®€å•çš„æ¸¸æˆå¾ªç¯

### ç¬¬äºŒå‘¨ï¼šæ ¸å¿ƒç§»åŠ¨
- [ ] ç©å®¶ç§»åŠ¨å’ŒåŠ¨ç”»
- [ ] ç›¸æœºç³»ç»Ÿ
- [ ] ç¢°æ’æ£€æµ‹
- [ ] è¾“å…¥ç®¡ç†

### ç¬¬ä¸‰å‘¨ï¼šæˆ˜æ–—ç³»ç»Ÿ
- [ ] åŸºç¡€æ”»å‡»
- [ ] 1ä¸ªé­”æ³•æŠ€èƒ½
- [ ] ç®€å•æ•ŒäººAI
- [ ] ä¼¤å®³è®¡ç®—

### ç¬¬å››å‘¨ï¼šUIé›†æˆ
- [ ] HUDæ˜¾ç¤º
- [ ] èƒŒåŒ…ç•Œé¢
- [ ] Reactä¸Phaseré€šä¿¡
- [ ] çŠ¶æ€ç®¡ç†

---

## âœ… æŠ€æœ¯éªŒè¯æ¸…å•

å¼€å‘å‰éœ€è¦éªŒè¯ï¼š

- [ ] Viteèƒ½å¦æ­£ç¡®åŠ è½½Phaserèµ„æº
- [ ] TypeScriptç±»å‹å®šä¹‰æ˜¯å¦å®Œå–„
- [ ] Reactä¸Phaserçš„é€šä¿¡æ˜¯å¦æµç•…
- [ ] åƒç´ æ¸²æŸ“æ˜¯å¦æ¸…æ™°ï¼ˆæ— æ¨¡ç³Šï¼‰
- [ ] æ€§èƒ½æ˜¯å¦è¾¾æ ‡ï¼ˆ60FPSï¼‰
- [ ] å­˜æ¡£ç³»ç»Ÿæ˜¯å¦å¯é 
- [ ] ä¸åŒå±å¹•å°ºå¯¸é€‚é…æ˜¯å¦æ­£å¸¸

---

## ğŸ”— å‚è€ƒèµ„æº

### å®˜æ–¹æ–‡æ¡£
- Phaser 3: https://photonstorm.github.io/phaser3-docs/
- Vite: https://vitejs.dev/
- Zustand: https://zustand-demo.pmnd.rs/

### æ•™ç¨‹
- Phaser 3 Examples: https://labs.phaser.io/
- Pixel Art Tutorial: https://lospec.com/pixel-art-tutorials
- Tiled Map Editor: https://doc.mapeditor.org/

### ç¤¾åŒº
- Phaser Discord: https://discord.gg/phaser
- Reddit r/gamedev: https://reddit.com/r/gamedev

---

**æŠ€æœ¯æ¶æ„ç‰ˆæœ¬**ï¼šv1.0  
**åˆ›å»ºæ—¥æœŸ**ï¼š2025å¹´10æœˆ15æ—¥  
**å…¼å®¹æ€§**ï¼šç°ä»£æµè§ˆå™¨ï¼ˆChrome 90+, Firefox 88+, Safari 14+ï¼‰

è¿™å¥—æŠ€æœ¯æ ˆæˆç†Ÿã€æ–‡æ¡£å®Œå–„ã€ç¤¾åŒºæ´»è·ƒï¼Œéå¸¸é€‚åˆä½ çš„åƒç´ æ¸¸æˆé¡¹ç›®ï¼ğŸ®âœ¨

