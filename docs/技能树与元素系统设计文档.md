# 职业与元素系统设计文档

> 版本：v2.0  
> 创建时间：2025-10-20  
> 更新时间：2025-10-20  
> 状态：设计阶段

---

## 📋 目录

1. [功能概述](#功能概述)
2. [核心设计理念](#核心设计理念)
3. [职业系统](#职业系统)
4. [元素属性系统](#元素属性系统)
5. [职业与元素组合](#职业与元素组合)
6. [技能树设计](#技能树设计)
7. [技能数据结构](#技能数据结构)
8. [UI设计](#ui设计)
9. [实现方案](#实现方案)
10. [数值平衡](#数值平衡)
11. [开发计划](#开发计划)

---

## 🎯 功能概述

### 目标
实现一个**职业×元素**双维度技能系统，玩家选择职业后，可以选择不同的元素进行精通，创造独特的战斗流派（如火法师、土盗贼、风战士等）。

### 核心特性
- ✅ 4种职业（战士、法师、盗贼、牧师）
- ✅ 4种元素属性（火、水、风、土）
- ✅ 16种组合流派（4职业×4元素）
- ✅ 双维度技能树
- ✅ 职业元素协同效果
- ✅ 技能点获取和分配
- ✅ 技能解锁和升级
- ✅ 重置功能

---

## 💡 核心设计理念

### 1. 双维度成长
- **职业维度**：定义战斗方式（近战/远程/辅助）
- **元素维度**：定义伤害属性和特殊效果
- **组合多样性**：4职业×4元素=16种流派

### 2. 职业为主，元素为辅
- **职业技能**：核心战斗技能，定义职业特色
- **元素精通**：提供元素加成和特殊效果
- **融合技能**：职业+元素的特殊技能

### 3. 策略性
- **技能点有限**：需要规划技能学习路线
- **职业专精**：专注职业还是兼顾元素
- **流派搭配**：职业与元素的化学反应

---

## ⚔️ 职业系统

### 职业选择

玩家在**Lv5**时选择职业，一旦选择**不可更改**（除非使用特殊道具）。

### 四大职业

#### 1. 战士 (Warrior) ⚔️
**定位**：近战物理输出、坦克

**特点**：
- 高生命值和防御
- 近距离高伤害
- 位移和控制技能
- 可吸收伤害保护队友

**核心机制**：
- **怒气系统**：受到伤害和攻击积累怒气，消耗怒气释放强力技能
- **格挡**：有概率格挡攻击
- **破甲**：降低敌人防御

**代表技能**：
- 旋风斩：范围物理伤害
- 盾墙：大幅提升防御
- 冲锋：突进并晕眩
- 斩杀：对低血量敌人高伤

#### 2. 法师 (Mage) 🔮
**定位**：远程魔法输出、AOE

**特点**：
- 高魔法伤害
- 远距离攻击
- 范围AOE技能
- 脆皮但爆发高

**核心机制**：
- **法力流动**：连续施法增加伤害（最多5层）
- **施法加速**：技能可减少其他技能冷却
- **魔法护盾**：吸收一定伤害

**代表技能**：
- 奥术飞弹：快速远程伤害
- 传送：瞬移到目标位置
- 时间扭曲：减速区域
- 法术强化：提升魔法伤害

#### 3. 盗贼 (Rogue) 🗡️
**定位**：高机动性、暴击、单体爆发

**特点**：
- 高暴击率和暴击伤害
- 灵活的位移能力
- 背刺和偷袭机制
- 隐身和逃脱

**核心机制**：
- **连击点系统**：攻击积累连击点，消耗释放终结技
- **背刺**：从背后攻击额外伤害
- **隐身**：潜行状态下首次攻击必暴击

**代表技能**：
- 背刺：背后攻击高伤
- 毒刃：附加持续伤害
- 暗影步：短距离瞬移
- 刺杀：消耗连击点的终结技

#### 4. 牧师 (Priest) ✨
**定位**：治疗辅助、控制、团队支援

**特点**：
- 强大的治疗能力
- 提供增益效果
- 控制和净化
- 持续战斗能力

**核心机制**：
- **神圣能量**：治疗和辅助技能积累，消耗释放强力技能
- **祈祷光环**：持续为范围内友军恢复
- **驱散**：移除负面状态

**代表技能**：
- 快速治疗：单体快速恢复
- 圣言术：群体治疗
- 神圣新星：范围伤害+治疗
- 复活：复活倒地队友

---

## 🔥 元素属性系统

### 元素精通机制

玩家可以在**任意等级**投入技能点学习元素精通，**不限制元素数量**，但：
- 每个元素有独立的精通等级（1-10级）
- 精通等级越高，该元素技能伤害越高
- 可以专精一个元素，也可以多元素发展

### 元素类型

#### 1. 火元素 🔥
**特点**：高伤害、持续燃烧、范围爆发

**核心机制**：
- **燃烧状态**：持续伤害（3秒）
- **爆炸连锁**：燃烧敌人死亡时爆炸
- **火焰增幅**：连续使用火技能增加伤害

**代表技能**：
- 火球术（Fireball）：基础单体伤害
- 火墙术（Fire Wall）：持续区域伤害
- 炎爆术（Explosion）：范围AOE爆发
- 陨石术（Meteor）：终极大招

#### 2. 水元素 💧
**特点**：治疗辅助、控制减速、持续恢复

**核心机制**：
- **湿润状态**：减速、增加受伤
- **生命恢复**：治疗自身或友军
- **冰冻效果**：与风元素协同冻结

**代表技能**：
- 治疗术（Heal）：恢复生命值
- 水盾术（Water Shield）：吸收伤害
- 冰霜箭（Ice Arrow）：减速敌人
- 寒冰风暴（Ice Storm）：范围控制

#### 3. 风元素 🌪️
**特点**：移动速度、多段攻击、控制位移

**核心机制**：
- **风压状态**：击退、浮空
- **速度加成**：提升移动和攻击速度
- **连击效果**：多次小伤害

**代表技能**：
- 疾风刃（Wind Blade）：快速多段攻击
- 龙卷风（Tornado）：控制和位移
- 风之庇护（Wind Shield）：增加闪避
- 暴风眼（Storm）：超强控制

#### 4. 土元素 🪨
**特点**：防御护盾、控制晕眩、持久战斗

**核心机制**：
- **护盾生成**：吸收伤害
- **石化状态**：定身控制
- **反伤机制**：受到伤害反弹

**代表技能**：
- 岩石护甲（Rock Armor）：增加防御
- 地刺术（Earth Spike）：单体高伤
- 岩壁术（Stone Wall）：地形阻挡
- 大地之怒（Earth Rage）：范围晕眩

### 元素克制关系

```
火 → 克制 → 风 → 克制 → 土 → 克制 → 水 → 克制 → 火
     ×1.3        ×1.3        ×1.3        ×1.3

相克额外伤害：+30%
```

### 元素协同效果

| 组合 | 效果 | 说明 |
|------|------|------|
| 火+风 | 火焰风暴 | 燃烧范围扩大，伤害提升 |
| 水+风 | 冰冻效果 | 敌人被冻结，无法移动 |
| 火+水 | 蒸汽爆炸 | 造成混合伤害 |
| 土+水 | 泥沼陷阱 | 大幅减速 |
| 火+土 | 熔岩地狱 | 持续伤害+减速 |
| 风+土 | 沙尘暴 | 降低命中率 |

---

## 🎭 职业与元素组合

### 组合特色

每个职业配合不同元素会产生独特的战斗风格和特殊效果。

### 战士 ⚔️ 组合

#### 火战士 🔥⚔️
**风格**：狂暴输出、持续燃烧
- **特殊效果**：攻击附带燃烧效果
- **融合技**：烈焰之刃 - 旋风斩附加火焰伤害
- **优势**：高爆发、清怪快
- **劣势**：防御一般

#### 水战士 💧⚔️
**风格**：生存坦克、持续作战
- **特殊效果**：受到伤害时触发生命恢复
- **融合技**：冰甲护盾 - 盾墙附加冰冻反伤
- **优势**：超高生存、持久战
- **劣势**：输出较低

#### 风战士 🌪️⚔️
**风格**：高机动、连击流
- **特殊效果**：攻击速度提升30%
- **融合技**：疾风突袭 - 冲锋可多次使用
- **优势**：极致机动、追击强
- **劣势**：单次伤害低

#### 土战士 🪨⚔️
**风格**：不动如山、反伤流
- **特殊效果**：受到伤害反弹50%
- **融合技**：大地之怒 - 旋风斩附加晕眩
- **优势**：防御最高、控制强
- **劣势**：缺乏位移

---

### 法师 🔮 组合

#### 火法师 🔥🔮（经典）
**风格**：极致爆发、AOE之王
- **特殊效果**：法术暴击率+20%
- **融合技**：末日审判 - 超大范围火焰风暴
- **优势**：最高输出、清屏能力
- **劣势**：最脆皮

#### 水法师 💧🔮
**风格**：控制流、冰霜法师
- **特殊效果**：技能附带减速效果
- **融合技**：寒冰禁锢 - 冻结敌人5秒
- **优势**：强力控制、风筝能力
- **劣势**：伤害中等

#### 风法师 🌪️🔮
**风格**：快速施法、持续输出
- **特殊效果**：施法速度+40%
- **融合技**：奥术风暴 - 超快速连续施法
- **优势**：DPS稳定、灵活
- **劣势**：爆发不足

#### 土法师 🪨🔮
**风格**：战斗法师、魔法坦克
- **特殊效果**：魔法护盾值+100%
- **融合技**：岩石召唤 - 召唤石头人协同作战
- **优势**：有防御的法师
- **劣势**：魔法伤害降低

---

### 盗贼 🗡️ 组合

#### 火盗贼 🔥🗡️
**风格**：爆发刺客、瞬秒流
- **特殊效果**：暴击伤害+50%
- **融合技**：烈焰刺杀 - 背刺附带爆炸
- **优势**：秒人能力强
- **劣势**：容易暴露

#### 水盗贼 💧🗡️
**风格**：毒刺客、持续削弱
- **特殊效果**：攻击附加冰冻减速
- **融合技**：寒霜之刃 - 持续冻伤效果
- **优势**：控制+输出
- **劣势**：需要时间叠加

#### 风盗贼 🌪️🗡️（最快）
**风格**：极速刺客、连击大师
- **特殊效果**：移动速度+50%，连击点积累速度翻倍
- **融合技**：风暴连击 - 瞬间打出5次攻击
- **优势**：最灵活、追击无敌
- **劣势**：单次伤害最低

#### 土盗贼 🪨🗡️（独特）
**风格**：重装刺客、破甲流
- **特殊效果**：攻击无视50%防御
- **融合技**：碎岩之刃 - 背刺额外破甲
- **优势**：打坦克强、生存高
- **劣势**：速度较慢

---

### 牧师 ✨ 组合

#### 火牧师 🔥✨
**风格**：惩戒牧师、输出治疗
- **特殊效果**：伤害转化为治疗
- **融合技**：神圣烈焰 - 范围伤害+群疗
- **优势**：战斗治疗、不易死
- **劣势**：治疗量一般

#### 水牧师 💧✨（经典）
**风格**：纯治疗、团队核心
- **特殊效果**：治疗量+50%
- **融合技**：生命之泉 - 持续群体恢复
- **优势**：治疗最强
- **劣势**：几乎无输出

#### 风牧师 🌪️✨
**风格**：辅助牧师、增益大师
- **特殊效果**：技能冷却-30%
- **融合技**：疾风祝福 - 全队速度提升
- **优势**：高频辅助、机动强
- **劣势**：单次治疗低

#### 土牧师 🪨✨
**风格**：防护牧师、护盾流
- **特殊效果**：护盾值+100%
- **融合技**：大地庇护 - 全队获得护盾
- **优势**：预防性治疗强
- **劣势**：应急治疗弱

---

## 🌳 技能树设计

### 双维度技能树

```
职业技能树（左侧）          元素精通树（右侧）
        ↓                          ↓
   [终极技能]                  [元素大招]
        ↑                          ↑
   [高级技能]                  [精通10级]
        ↑                          ↑
   [基础技能]                  [精通5级]
        ↑                          ↑
   [职业选择]                  [精通1级]
```

### 技能树结构

每个元素有**独立的技能树**，分为4层：

```
第1层（入门）：基础技能（消耗1点）
    ↓
第2层（进阶）：强化技能（消耗2点，需要第1层任意1个）
    ↓
第3层（精通）：高级技能（消耗3点，需要第2层对应分支）
    ↓
第4层（终极）：终极技能（消耗5点，需要第3层相关技能）
```

### 火元素技能树示例

```
                    陨石术 [5点]
                   /            \
            炎爆术 [3点]      地狱火 [3点]
              /                    \
        火墙术 [2点]            烈焰风暴 [2点]
            \                      /
                火球术 [1点]
```

### 技能点获取

| 来源 | 获得点数 | 说明 |
|------|---------|------|
| 等级提升 | 1点/5级 | Lv5、Lv10、Lv15... |
| 完成任务 | 1-3点 | 主线任务奖励 |
| 击败BOSS | 2-5点 | 关键战斗 |
| 探索发现 | 1点 | 发现隐藏区域 |

**示例**：
- Lv1-50：可获得10点
- 主线任务：约15点
- 支线任务：约10点
- BOSS击杀：约10点
- **总计**：约45-50点技能点

### 技能升级

每个技能可以升级**1-5级**：

| 等级 | 消耗 | 效果提升 |
|------|------|----------|
| Lv1 | 初始 | 基础效果 |
| Lv2 | +1点 | 伤害+20% |
| Lv3 | +2点 | 伤害+40%，冷却-10% |
| Lv4 | +3点 | 伤害+60%，冷却-20% |
| Lv5 | +4点 | 伤害+100%，特殊效果 |

**总消耗**：1+1+2+3+4 = 11点（满级一个技能）

---

## 💾 技能数据结构

### 技能定义

```typescript
interface Skill {
  id: string;
  name: string;
  element: 'fire' | 'water' | 'wind' | 'earth';
  tier: 1 | 2 | 3 | 4;  // 技能层级
  
  // 基础属性
  description: string;
  icon: string;
  
  // 消耗
  cost: number;          // 学习消耗的技能点
  manaCost: number;      // 释放消耗的魔力
  cooldown: number;      // 冷却时间（秒）
  
  // 效果
  damage: number;        // 基础伤害
  radius?: number;       // 作用范围
  duration?: number;     // 持续时间
  
  // 前置条件
  prerequisites: string[]; // 前置技能ID
  requiredLevel: number;   // 需要的等级
  
  // 升级
  currentLevel: number;    // 当前等级 0-5
  maxLevel: number;        // 最大等级
  
  // 特殊效果
  effects?: SkillEffect[];
}

interface SkillEffect {
  type: 'burn' | 'freeze' | 'slow' | 'stun' | 'heal' | 'shield';
  value: number;
  duration: number;
}
```

### 技能树数据

```typescript
interface SkillTree {
  element: ElementType;
  totalPoints: number;      // 该元素已投入的点数
  skills: Map<string, Skill>;
  unlockedSkills: string[]; // 已解锁的技能ID
}

interface SkillTreeState {
  availablePoints: number;  // 可用技能点
  fireTree: SkillTree;
  waterTree: SkillTree;
  windTree: SkillTree;
  earthTree: SkillTree;
  equippedSkills: string[]; // 装备的技能（最多4个）
}
```

---

## 🎨 UI设计

### 技能树界面布局

```
┌─────────────────────────────────────────────────────┐
│  🔥 火  💧 水  🌪️ 风  🪨 土     [可用点数: 5]      │
├─────────────────────────────────────────────────────┤
│                                                      │
│                    [陨石术]                          │
│                    Lv 0/5                           │
│                   需要: 5点                          │
│                     ↑                               │
│            [炎爆术]    [地狱火]                      │
│            Lv 2/5      Lv 0/5                       │
│               ↑           ↑                         │
│         [火墙术]      [烈焰风暴]                     │
│         Lv 3/5         Lv 1/5                       │
│               ↘         ↙                           │
│                [火球术]                              │
│                Lv 5/5                               │
│                已精通                                │
│                                                      │
├─────────────────────────────────────────────────────┤
│  [选中技能详情]                                      │
│  ━━━━━━━━━━━━━━━━━━━━━━━━━                        │
│  🔥 火球术 Lv.5 (MAX)                               │
│  发射一枚火球，造成火焰伤害                          │
│                                                      │
│  伤害: 80 (+20)                                     │
│  魔力: 15                                           │
│  冷却: 2秒                                          │
│  范围: 单体                                          │
│                                                      │
│  特殊: 有30%几率造成燃烧效果                         │
│                                                      │
│  [升级] (需要3点)  [装备]  [查看详情]                │
└─────────────────────────────────────────────────────┘
```

### 技能图标状态

| 状态 | 显示效果 |
|------|----------|
| 未解锁 | 灰色半透明，显示锁图标 |
| 可学习 | 彩色边框闪烁 |
| 已学习 | 正常显示，显示等级 |
| 已满级 | 金色边框，显示"MAX" |
| 已装备 | 绿色角标标记 |

### 技能装备栏

```
快捷栏（底部）:
┌────┬────┬────┬────┐
│ 1  │ 2  │ 3  │ 4  │
│ 🔥 │ 💧 │ 🌪️ │ 🪨 │
└────┴────┴────┴────┘
 火球  治疗  疾风  护甲
```

---

## 🔧 实现方案

### Phase 1: 数据系统（3-4小时）

#### 1.1 技能数据定义
```typescript
// src/data/skills.ts
export const FIRE_SKILLS: Skill[] = [
  {
    id: 'fireball',
    name: '火球术',
    element: 'fire',
    tier: 1,
    cost: 1,
    manaCost: 15,
    cooldown: 2,
    damage: 50,
    // ...
  },
  // ... more skills
];
```

#### 1.2 技能树管理器
```typescript
// src/systems/SkillTreeSystem.ts
export class SkillTreeSystem {
  static canLearnSkill(skillId: string): boolean;
  static learnSkill(skillId: string): boolean;
  static upgradeSkill(skillId: string): boolean;
  static equipSkill(skillId: string, slot: number): void;
  static resetSkillTree(element: ElementType): void;
}
```

### Phase 2: 技能效果（4-5小时）

#### 2.1 技能释放
```typescript
// src/game/skills/SkillManager.ts
export class SkillManager {
  castSkill(skillId: string, target: Position): void;
  applySkillEffect(skill: Skill, targets: Entity[]): void;
  calculateDamage(skill: Skill, target: Entity): number;
}
```

#### 2.2 元素效果
```typescript
// src/game/effects/ElementalEffects.ts
export class ElementalEffects {
  applyBurn(target: Entity, duration: number): void;
  applyFreeze(target: Entity, duration: number): void;
  applySlow(target: Entity, amount: number): void;
  // ...
}
```

### Phase 3: UI实现（5-6小时）

#### 3.1 技能树组件
```typescript
// src/ui/components/SkillTree.tsx
export const SkillTree: React.FC = () => {
  // 显示技能树
  // 处理学习/升级
  // 显示连接线
};
```

#### 3.2 技能详情面板
```typescript
// src/ui/components/SkillDetail.tsx
export const SkillDetail: React.FC<{ skill: Skill }> = () => {
  // 显示技能详细信息
  // 显示升级效果
  // 学习/升级按钮
};
```

#### 3.3 技能快捷栏
```typescript
// src/ui/components/SkillBar.tsx
export const SkillBar: React.FC = () => {
  // 显示装备的技能
  // 冷却显示
  // 快捷键提示
};
```

### Phase 4: 集成测试（2-3小时）

- 测试技能学习
- 测试技能释放
- 测试元素效果
- 测试数据持久化

---

## ⚖️ 数值平衡

### 技能伤害公式

```typescript
// 基础伤害
baseDamage = skill.damage * (1 + skill.level * 0.2)

// 元素加成
elementBonus = player.magic * 0.5

// 克制加成
counterBonus = isCounter ? 1.3 : 1.0

// 最终伤害
finalDamage = (baseDamage + elementBonus) * counterBonus
```

### 技能冷却

| 技能层级 | 基础冷却 | 升级减少 |
|---------|----------|----------|
| Tier 1 | 2-3秒 | -10%/级 |
| Tier 2 | 5-8秒 | -8%/级 |
| Tier 3 | 10-15秒 | -5%/级 |
| Tier 4 | 30-60秒 | -3%/级 |

### 魔力消耗

| 技能层级 | 基础消耗 | 升级变化 |
|---------|----------|----------|
| Tier 1 | 10-20 | +2/级 |
| Tier 2 | 25-40 | +3/级 |
| Tier 3 | 50-80 | +5/级 |
| Tier 4 | 100-150 | +8/级 |

---

## 📅 开发计划

### 第一阶段：核心系统（预计8小时）
- [x] 设计文档编写
- [ ] 技能数据结构定义
- [ ] 技能树数据准备
- [ ] SkillTreeSystem实现
- [ ] 状态管理扩展

### 第二阶段：技能效果（预计8小时）
- [ ] SkillManager实现
- [ ] 元素效果系统
- [ ] 技能释放动画
- [ ] 元素克制逻辑

### 第三阶段：UI实现（预计10小时）
- [ ] SkillTree组件
- [ ] SkillDetail组件
- [ ] SkillBar组件
- [ ] 技能图标和动画
- [ ] 连接线绘制

### 第四阶段：集成测试（预计4小时）
- [ ] 功能测试
- [ ] 数值平衡测试
- [ ] UI/UX优化
- [ ] 性能测试

**总计工作量**：30小时

---

## 🎯 技能树路线示例

### 火焰法师路线
```
火球术 Lv5 → 火墙术 Lv5 → 炎爆术 Lv5 → 陨石术 Lv3
总消耗：1+10+1+10+1+10+5+4 = 42点
特点：极致火力输出
```

### 冰霜控制路线
```
治疗术 Lv3 → 水盾术 Lv5 → 冰霜箭 Lv5 → 寒冰风暴 Lv3
总消耗：1+4+1+10+1+10+5+4 = 36点
特点：控制+生存
```

### 混合元素路线
```
火球术 Lv3 + 疾风刃 Lv3 + 岩石护甲 Lv5 + 治疗术 Lv3
总消耗：1+4+1+4+1+10+1+4 = 26点
特点：全面均衡
```

---

## ✅ 验收标准

### 功能完整性
- [ ] 4个元素技能树完整
- [ ] 每个元素至少8个技能
- [ ] 技能学习和升级正常
- [ ] 技能装备系统正常
- [ ] 技能释放和效果正常
- [ ] 元素克制生效
- [ ] 元素协同生效
- [ ] 技能点获取正常
- [ ] 重置功能正常
- [ ] 数据持久化正常

### 用户体验
- [ ] 技能树布局清晰
- [ ] 操作流畅
- [ ] 反馈及时
- [ ] 动画流畅
- [ ] 信息完整

### 数值平衡
- [ ] 伤害曲线合理
- [ ] 技能点分配合理
- [ ] 各元素平衡
- [ ] 技能性价比均衡

---

## 📝 后续扩展

### v2.0 功能
- [ ] 第5元素（光/暗）
- [ ] 更多技能（每元素12个）
- [ ] 技能符文系统
- [ ] 技能皮肤

### v3.0 功能
- [ ] 终极技能组合
- [ ] 元素觉醒系统
- [ ] 技能挑战模式
- [ ] 技能排行榜

---

**文档版本**：v1.0  
**创建日期**：2025-10-20  
**维护者**：项目团队  
**状态**：设计完成，待实现

**开始实现前请确保所有设计细节已确认！** 📝✨🎮
