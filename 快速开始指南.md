# 快速开始指南

> 5分钟搭建开发环境，10分钟看到第一个像素在屏幕上移动！

---

## 📋 前置要求

### 必需软件
- **Node.js** 18.x 或更高版本
- **npm** 9.x 或 **pnpm** 8.x（推荐pnpm，速度更快）
- **Git**
- **代码编辑器**：VSCode（推荐）

### 可选软件
- **Aseprite**（像素绘图）
- **Tiled**（地图编辑器）

---

## 🚀 环境搭建（5分钟）

### 步骤1：创建项目

```bash
# 使用 Vite 创建项目
npm create vite@latest forgotten-pixel-realm -- --template react-ts

# 进入项目目录
cd forgotten-pixel-realm

# 安装依赖
npm install
```

### 步骤2：安装游戏依赖

```bash
# 安装 Phaser 3
npm install phaser

# 安装状态管理
npm install zustand immer

# 安装工具库
npm install uuid

# 安装类型定义
npm install -D @types/uuid
```

### 步骤3：安装开发工具

```bash
# 安装 TailwindCSS（UI样式）
npm install -D tailwindcss postcss autoprefixer
npx tailwindcss init -p

# 安装测试工具
npm install -D vitest @vitest/ui

# 安装 ESLint 配置
npm install -D @typescript-eslint/eslint-plugin @typescript-eslint/parser
```

### 步骤4：配置项目结构

```bash
# 创建目录结构
mkdir -p src/game/{scenes,entities,systems,managers,utils}
mkdir -p src/ui/{components,hooks}
mkdir -p src/store
mkdir -p src/types
mkdir -p src/constants
mkdir -p public/assets/{sprites,tilesets,audio,ui,data}
```

---

## 🎮 第一个Demo（10分钟）

### 1. 配置 Vite

创建 `vite.config.ts`：

```typescript
import { defineConfig } from 'vite';
import react from '@vitejs/plugin-react';
import path from 'path';

export default defineConfig({
  plugins: [react()],
  resolve: {
    alias: {
      '@': path.resolve(__dirname, './src'),
      '@game': path.resolve(__dirname, './src/game'),
      '@ui': path.resolve(__dirname, './src/ui'),
    },
  },
  server: {
    port: 3000,
  },
});
```

### 2. 创建 Phaser 游戏实例

创建 `src/game/index.ts`：

```typescript
import Phaser from 'phaser';

class GameScene extends Phaser.Scene {
  constructor() {
    super({ key: 'GameScene' });
  }

  preload() {
    // 暂时用颜色代替精灵
  }

  create() {
    // 创建一个简单的方块代表玩家
    const player = this.add.rectangle(400, 300, 32, 32, 0x00ff00);
    this.physics.add.existing(player);

    // 添加键盘控制
    const cursors = this.input.keyboard!.createCursorKeys();

    this.events.on('update', () => {
      const body = player.body as Phaser.Physics.Arcade.Body;
      
      body.setVelocity(0);
      
      if (cursors.left.isDown) body.setVelocityX(-160);
      else if (cursors.right.isDown) body.setVelocityX(160);
      
      if (cursors.up.isDown) body.setVelocityY(-160);
      else if (cursors.down.isDown) body.setVelocityY(160);
    });

    // 添加文字提示
    this.add.text(10, 10, '使用方向键移动绿色方块', {
      fontSize: '16px',
      color: '#ffffff',
    });
  }
}

export function createGame(parent: string) {
  const config: Phaser.Types.Core.GameConfig = {
    type: Phaser.AUTO,
    width: 800,
    height: 600,
    parent,
    backgroundColor: '#2d2d2d',
    physics: {
      default: 'arcade',
      arcade: {
        gravity: { x: 0, y: 0 },
      },
    },
    scene: [GameScene],
  };

  return new Phaser.Game(config);
}
```

### 3. 集成到 React

修改 `src/App.tsx`：

```typescript
import { useEffect, useRef } from 'react';
import { createGame } from './game';

function App() {
  const gameRef = useRef<Phaser.Game | null>(null);
  const parentRef = useRef<HTMLDivElement>(null);

  useEffect(() => {
    if (parentRef.current && !gameRef.current) {
      gameRef.current = createGame('game-container');
    }

    return () => {
      gameRef.current?.destroy(true);
    };
  }, []);

  return (
    <div className="w-screen h-screen bg-gray-900 flex items-center justify-center">
      <div id="game-container" ref={parentRef} />
    </div>
  );
}

export default App;
```

### 4. 配置 TailwindCSS

修改 `tailwind.config.js`：

```javascript
/** @type {import('tailwindcss').Config} */
export default {
  content: [
    "./index.html",
    "./src/**/*.{js,ts,jsx,tsx}",
  ],
  theme: {
    extend: {},
  },
  plugins: [],
}
```

在 `src/index.css` 中添加：

```css
@tailwind base;
@tailwind components;
@tailwind utilities;
```

### 5. 运行项目

```bash
npm run dev
```

打开浏览器访问 http://localhost:3000

你应该能看到一个绿色方块，可以用方向键控制移动！🎉

---

## 📦 资源准备

### 临时测试资源

在没有美术资源前，可以使用这些方法：

#### 1. 使用纯色代替精灵

```typescript
// 创建一个彩色方块
const player = this.add.rectangle(x, y, 16, 24, 0x00ff00);
```

#### 2. 在线像素资源库

- **OpenGameArt**: https://opengameart.org/
- **itch.io**: https://itch.io/game-assets/free
- **Kenney**: https://kenney.nl/assets (免费资源包)

推荐：**Kenney的Tiny Dungeon包**，适合原型开发

#### 3. 快速生成占位符

```bash
# 使用 ImageMagick 生成测试图片
convert -size 16x16 xc:#00ff00 player.png
convert -size 16x16 xc:#ff0000 enemy.png
```

---

## 🛠️ VSCode 推荐配置

### 推荐插件

```json
// .vscode/extensions.json
{
  "recommendations": [
    "dbaeumer.vscode-eslint",
    "esbenp.prettier-vscode",
    "bradlc.vscode-tailwindcss",
    "usernamehw.errorlens",
    "ZixuanChen.vitest-explorer"
  ]
}
```

### 工作区设置

```json
// .vscode/settings.json
{
  "editor.formatOnSave": true,
  "editor.defaultFormatter": "esbenp.prettier-vscode",
  "editor.codeActionsOnSave": {
    "source.fixAll.eslint": true
  },
  "typescript.tsdk": "node_modules/typescript/lib",
  "files.exclude": {
    "**/.git": true,
    "**/node_modules": true,
    "**/dist": true
  }
}
```

### 调试配置

```json
// .vscode/launch.json
{
  "version": "0.2.0",
  "configurations": [
    {
      "type": "chrome",
      "request": "launch",
      "name": "启动游戏调试",
      "url": "http://localhost:3000",
      "webRoot": "${workspaceFolder}/src",
      "sourceMaps": true
    }
  ]
}
```

---

## 📝 开发工作流

### 日常开发

```bash
# 启动开发服务器
npm run dev

# 新终端窗口：运行测试（监视模式）
npm run test

# 新终端窗口：类型检查
npm run type-check
```

### 代码规范

```bash
# 检查代码规范
npm run lint

# 自动修复
npm run lint:fix

# 格式化代码
npm run format
```

### 构建和预览

```bash
# 构建生产版本
npm run build

# 预览构建结果
npm run preview
```

---

## 🎯 第一周开发目标

### Day 1：环境搭建
- [x] 安装依赖
- [ ] 运行第一个Demo
- [ ] 熟悉项目结构

### Day 2：玩家移动
- [ ] 实现8方向移动
- [ ] 添加相机跟随
- [ ] 添加移动动画（或方向改变）

### Day 3：地图系统
- [ ] 学习 Tiled 使用
- [ ] 创建简单地图（10x10）
- [ ] 加载地图到游戏

### Day 4：碰撞检测
- [ ] 添加墙壁图层
- [ ] 实现玩家与墙壁碰撞
- [ ] 添加碰撞反馈

### Day 5：第一个敌人
- [ ] 创建敌人实体
- [ ] 简单巡逻AI
- [ ] 敌人与玩家碰撞

### Day 6-7：迷雾效果
- [ ] 实现基础迷雾视觉
- [ ] 玩家视野范围
- [ ] 净化效果

---

## 🆘 常见问题

### Q1: Phaser 无法加载资源

**问题**：`Failed to load resource: 404`

**解决**：
- 确保资源路径以 `/` 开头（如 `/assets/player.png`）
- 检查文件是否在 `public` 目录下
- 刷新浏览器缓存

### Q2: TypeScript 报错找不到模块

**问题**：`Cannot find module '@/game/...'`

**解决**：
```bash
# 重启 TS 服务器
VSCode: Cmd+Shift+P -> "TypeScript: Restart TS Server"

# 或重新安装依赖
rm -rf node_modules package-lock.json
npm install
```

### Q3: 性能问题（FPS低）

**解决**：
- 检查是否开启了物理引擎的 debug 模式
- 减少屏幕上的对象数量
- 使用对象池复用对象
- 查看浏览器控制台是否有错误

### Q4: 热更新不工作

**解决**：
```bash
# 清除缓存重启
rm -rf node_modules/.vite
npm run dev
```

---

## 📚 学习资源

### 新手教程

#### Phaser 3
1. **官方教程**：https://phaser.io/tutorials/making-your-first-phaser-3-game
2. **Phaser Examples**：https://labs.phaser.io/
3. **视频教程**：搜索 "Phaser 3 tutorial" on YouTube

#### TypeScript
- **官方文档**：https://www.typescriptlang.org/docs/
- **TypeScript Handbook**（中文）：https://typescript.p6p.net/

#### 游戏开发概念
- **Game Programming Patterns**：https://gameprogrammingpatterns.com/
- **2D Game Fundamentals**：理解帧循环、碰撞检测、状态机

### 进阶资源

- **Phaser 3 Examples**：https://github.com/photonstorm/phaser3-examples
- **ECS 架构**：学习实体组件系统
- **寻路算法**：A* pathfinding
- **状态机**：敌人AI实现

---

## 🎨 美术资源获取

### 免费资源站

1. **OpenGameArt.org**
   - 完全免费
   - 质量参差不齐
   - 需要注意许可证

2. **itch.io**
   - 很多免费像素包
   - 质量较高
   - 有付费精品

3. **Kenney.nl**
   - 所有资源CC0（完全免费）
   - 风格统一
   - 强烈推荐用于原型

### 付费资源（可选）

- **Humble Bundle**：经常有像素游戏资源包特价
- **Asset Store**：Unity Asset Store 也有很多2D资源
- **Patreon**：很多像素艺术家在上面

### 外包平台

如果需要定制美术：
- **Fiverr**：$50-500
- **Upwork**：$20-80/小时
- **国内威客网站**：猪八戒、一品威客

---

## ✅ 检查清单

### 环境搭建完成
- [ ] Node.js 和 npm 已安装
- [ ] 项目创建成功
- [ ] 依赖安装完成
- [ ] 开发服务器能运行
- [ ] 能看到绿色方块并移动

### 开发工具配置
- [ ] VSCode 插件已安装
- [ ] ESLint 工作正常
- [ ] Git 仓库已初始化
- [ ] .gitignore 已配置

### 准备就绪
- [ ] 阅读了技术架构文档
- [ ] 理解了项目结构
- [ ] 知道去哪里找学习资源
- [ ] 准备开始真正的开发

---

## 🚀 下一步

完成快速开始后，建议按以下顺序阅读文档：

1. **技术架构文档** - 理解整体架构
2. **开发路线图** - 了解开发节奏
3. **功能特性列表** - 知道要做什么
4. **视觉设计指南** - 理解美术需求

然后开始第一周的开发任务！

---

## 💬 获取帮助

遇到问题时：

1. **查看文档**：本项目的文档应该能回答大部分问题
2. **搜索引擎**：Google/Stack Overflow
3. **官方社区**：
   - Phaser Discord: https://discord.gg/phaser
   - Reddit r/gamedev: https://reddit.com/r/gamedev
4. **AI助手**：Claude/ChatGPT 可以帮助解决代码问题

---

**祝你开发顺利！记住：先让它跑起来，再让它变完美。** 🎮✨

第一个像素动起来的时候，你会感到巨大的成就感！加油！💪

