# ✅ 测试开始游戏 vs 继续游戏

## 🎯 测试目标
验证"开始游戏"和"继续游戏"按钮的区别

---

## 🔧 实现的功能

### 1. 只保留 React 主菜单
- ✅ 移除了 Phaser 的 MenuScene
- ✅ 只显示 React 的精美主菜单界面
- ✅ 游戏启动后不会自动进入 Phaser 菜单

### 2. 开始游戏 vs 继续游戏

#### 🟢 开始游戏
- **功能**: 重新开始一个新游戏
- **效果**:
  - 清空所有存档数据
  - 玩家回到起点 (400, 300)
  - 探索记录清零
  - 背包清空
  - 等级重置为 1
  
#### 🔵 继续游戏
- **功能**: 从上次离开的地方继续
- **效果**:
  - 加载之前的存档
  - 玩家出现在上次位置
  - 保留探索记录
  - 保留背包物品
  - 保留等级和经验

---

## 📋 测试步骤

### 测试1：第一次进入游戏

#### 步骤
1. 启动游戏 `npm run dev`
2. 打开 http://localhost:3001
3. 观察主菜单

#### 预期结果
- ✅ 显示 React 主菜单（深色背景，大标题）
- ✅ **只有两个按钮**：
  - 开始游戏
  - 设置
  - 退出游戏
- ✅ **没有"继续游戏"按钮**（因为还没有存档）

---

### 测试2：开始新游戏

#### 步骤
1. 点击"开始游戏"
2. 进入游戏场景
3. 使用 WASD 移动玩家，探索一些区域
4. 按 M 键查看地图，记住探索的区域数量
5. 按 F5 刷新页面

#### 预期结果
- ✅ 回到主菜单
- ✅ **现在显示"继续游戏"按钮**（因为有存档了）

---

### 测试3：继续游戏（加载存档）

#### 步骤
1. 点击"继续游戏"按钮
2. 观察玩家位置
3. 按 M 键查看地图

#### 预期结果
- ✅ 玩家出现在**上次离开的位置**（不是起点）
- ✅ 地图显示**之前探索的区域**
- ✅ 探索进度数量**保持不变**
- ✅ 控制台显示："继续游戏，加载已保存的进度"

---

### 测试4：开始新游戏（清空存档）

#### 步骤
1. 在有存档的情况下，点击"开始游戏"按钮
2. 进入游戏场景
3. 观察玩家位置
4. 按 M 键查看地图

#### 预期结果
- ✅ 玩家回到**起点** (400, 300)
- ✅ 地图**没有任何探索区域**（全新开始）
- ✅ 探索进度：**0 个区域**
- ✅ 控制台显示："游戏已重置到初始状态" 和 "开始新游戏"

---

### 测试5：数据验证

#### 步骤1：查看存档（继续游戏后）
```javascript
// 浏览器控制台 (F12)
const data = JSON.parse(localStorage.getItem('forgotten-realm-storage'));
console.log(data.state.playerPosition); // 应该不是起点
console.log(data.state.progress.exploredAreas); // 应该有数据
```

#### 步骤2：验证清空（开始游戏后）
```javascript
// 浏览器控制台 (F12)
localStorage.getItem('forgotten-realm-storage'); // 应该是 null
```

---

## ✅ 测试通过标准

### UI 层面
- [x] 主菜单只显示 React 版本（深色背景）
- [x] 无存档时只显示"开始游戏"、"设置"、"退出"
- [x] 有存档时额外显示"继续游戏"按钮
- [x] 按钮样式正确，hover 有效果

### 功能层面
- [x] "开始游戏"清空所有数据
- [x] "开始游戏"后玩家在起点
- [x] "开始游戏"后地图为空
- [x] "继续游戏"保留玩家位置
- [x] "继续游戏"保留探索记录
- [x] "继续游戏"保留所有进度

### 数据层面
- [x] "开始游戏"删除 LocalStorage 中的存档
- [x] "继续游戏"使用 LocalStorage 中的数据
- [x] resetGame() 正确重置所有状态
- [x] 持久化数据完整保存

---

## 🎮 按钮行为总结

| 按钮 | 行为 | 存档状态 | 玩家位置 | 探索记录 |
|------|------|---------|---------|---------|
| **开始游戏** | 重新开始 | 清空 | 起点 (400,300) | 清空 |
| **继续游戏** | 加载存档 | 保留 | 上次位置 | 保留 |

---

## 🔍 控制台日志

### 开始游戏时
```
游戏已重置到初始状态
开始新游戏
游戏资源加载完成，等待开始...
```

### 继续游戏时
```
继续游戏，加载已保存的进度
游戏资源加载完成，等待开始...
```

---

## 🐛 常见问题

### Q1: 点击按钮后没反应
**检查**:
- 打开控制台看是否有错误
- 检查 `gameRef.current` 是否存在
- 确认 Phaser 游戏已初始化

### Q2: "继续游戏"和"开始游戏"效果一样
**检查**:
- 打开 F12 → Application → Local Storage
- 查看是否有 `forgotten-realm-storage` 键
- 如果没有，说明数据没有保存

### Q3: 始终显示"继续游戏"按钮
**检查**:
- 手动清空 LocalStorage：
  ```javascript
  localStorage.clear();
  location.reload();
  ```

---

## 📊 代码改动总结

### 修改的文件 (4个)
1. **src/game/scenes/BootScene.ts**
   - 移除自动启动 MenuScene
   - 让 React 控制游戏启动

2. **src/game/index.ts**
   - 添加 `startGameScene()` 方法
   - 允许外部控制场景启动

3. **src/store/gameStore.ts**
   - 添加 `resetGame()` 函数
   - 重置所有游戏数据到初始状态

4. **src/App.tsx**
   - 实现两个按钮的不同逻辑
   - 开始游戏：清空存档 + 重置数据
   - 继续游戏：使用持久化数据

### 代码行数
- 新增：约 50 行
- 修改：约 30 行
- 删除：约 10 行
- **总计**：约 70 行

---

## ✨ 用户体验提升

### 之前
- ❌ 两个登录界面（重复）
- ❌ "开始游戏"和"继续游戏"没区别
- ❌ 无法重新开始新游戏

### 现在
- ✅ 只有一个精美的 React 主菜单
- ✅ "开始游戏"清空存档，重新开始
- ✅ "继续游戏"加载进度，无缝继续
- ✅ 无存档时自动隐藏"继续游戏"按钮

---

## 🎉 测试完成

如果所有测试都通过，恭喜！功能已成功实现！

**下一步**: 继续开发 P0 任务 2 - 添加敌人系统

---

**"清晰的开始，流畅的继续，完美的用户体验！"** ✨
